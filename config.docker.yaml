# Docker 部署专用配置
# 所有敏感信息通过环境变量注入

# Application Configuration
app:
  name: "Binance Futures Analysis"
  version: "1.0.0"
  environment: "production"
  timezone: "UTC"

# Server Configuration
server:
  host: "0.0.0.0"
  port: 8081
  read_timeout: 30s
  write_timeout: 30s

# Binance API Configuration
binance:
  api_url: "https://fapi.binance.com"
  api_key: ""      # ENV: CA_BINANCE_API_KEY
  api_secret: ""   # ENV: CA_BINANCE_API_SECRET
  rate_limit:
    requests_per_minute: 1200
    weight_per_minute: 2400
  timeout: 10s

# Data Collection Configuration
collection:
  enabled: true
  interval: "0 0 * * * *"
  pair_filter:
    quote_asset: "USDT"
    exclude_pairs: []
  retry:
    max_attempts: 3
    delay: 5s
    backoff_multiplier: 2

# Database Configuration
database:
  type: "mysql"

  mysql:
    host: "mysql"           # Docker service name
    port: 3306
    database: "futures_analysis"
    username: "futures"     # ENV: CA_DATABASE_MYSQL_USERNAME
    password: ""            # ENV: CA_DATABASE_MYSQL_PASSWORD
    charset: "utf8mb4"
    parse_time: true
    max_open_conns: 25
    max_idle_conns: 5
    conn_max_lifetime: 5m
    conn_max_idle_time: 10m
    slow_query_threshold: 200ms

  redis:
    host: "redis"           # Docker service name
    port: 6379
    password: ""            # ENV: CA_DATABASE_REDIS_PASSWORD
    db: 0
    pool_size: 10
    min_idle_conns: 5
    max_retries: 3
    dial_timeout: 5s
    read_timeout: 3s
    write_timeout: 3s

# Strategy Configuration
strategies:
  minority:
    enabled: true
    name: "Minority Follower"
    min_ratio_difference: 60.0
    confirmation_hours: 2
    generate_long_when_short_ratio_above: 60.0
    generate_short_when_long_ratio_above: 60.0
    tracking_hours: 24
    profit_target_pct: 5.0
    stop_loss_pct: 2.0

  whale:
    enabled: true
    name: "Whale Position Analysis"
    min_ratio_difference: 60.0
    whale_position_threshold: 52.0
    confirmation_hours: 2
    min_divergence: 15.0
    tracking_hours: 24
    profit_target_pct: 5.0
    stop_loss_pct: 2.0

  # Smart Money Strategy: Liquidity Grabs & SFP
  smart_money:
    enabled: true
    name: "Smart Money (Liquidity Grab)"
    min_long_account_ratio: 60.0      # Relaxed from 65.0 to 60.0
    lookback_period: 24               # Look back 24 candles for High
    kline_interval: "1h"              # 1-hour candles
    confirmation_hours: 1
    tracking_hours: 24
    profit_target_pct: 6.0            # Higher reward for SFP
    stop_loss_pct: 1.5                # Tight stop above wick


  global:
    min_volume_24h: 1000000
    max_concurrent_signals_per_pair: 3
    signal_cooldown_hours: 6

# Statistics Configuration
statistics:
  calculation_interval: "0 0 */6 * * *"
  periods:
    - "24h"
    - "7d"
    - "30d"
    - "all"
  percentiles: [25, 50, 75, 90, 95]

# Notification Configuration
notifications:
  telegram:
    enabled: false
    bot_token: ""    # ENV: CA_NOTIFICATIONS_TELEGRAM_BOT_TOKEN
    chat_ids: []     # ENV: CA_NOTIFICATIONS_TELEGRAM_CHAT_IDS
    events:
      - "signal_generated"
      - "signal_confirmed"
      - "signal_outcome"
      - "system_error"

  email:
    enabled: false
    smtp_host: "smtp.gmail.com"
    smtp_port: 587
    username: ""
    password: ""
    from: ""
    to: []
    events:
      - "signal_confirmed"
      - "system_error"

  webhook:
    enabled: false
    url: ""
    method: "POST"
    headers:
      Content-Type: "application/json"
    timeout: 10s
    events:
      - "signal_generated"
      - "signal_confirmed"

  console:
    enabled: true
    events:
      - "signal_generated"
      - "signal_confirmed"
      - "signal_invalidated"
      - "signal_outcome"

# Logging Configuration - Docker 优化
logging:
  level: "info"
  format: "json"
  output:
    - "stdout"      # Docker 推荐输出到 stdout
  file:
    path: "/app/logs/app.log"
    max_size: 50
    max_backups: 3
    max_age: 7
    compress: true

# Monitoring Configuration
monitoring:
  enabled: true
  metrics:
    enabled: true
    port: 9090
    path: "/metrics"
  health_check:
    enabled: true
    path: "/health"

# Feature Flags
features:
  backtest_mode: false
  dry_run: false
  debug_signals: false